<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ•·ï¸ Advanced Spider Robot Control</title>
    <!-- CSS dosya yolu Flask'Ä±n url_for yapÄ±sÄ±yla daha gÃ¼venli hale getirildi -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <h1>ğŸ•·ï¸ Advanced Spider Robot Control System</h1>

    <div class="container">
        <div class="panel video-panel">
            <h2>ğŸ“¹ Live Video Feed</h2>
            <div class="video-container">
                <img id="videoFeed" src="/video_feed" alt="Video Feed">
            </div>
            <div class="button-row">
                <button onclick="startCamera()">ğŸ“· Start Camera</button>
                <button class="toggle-btn" id="trackingBtn" onclick="toggleTracking()">ğŸ¯ Enable Tracking</button>
                <button class="toggle-btn" id="cameraTrackingBtn" onclick="toggleCameraTracking()">ğŸ“¹ Enable Camera Tracking</button>
                <button class="emergency-btn" onclick="emergencyStop()">ğŸ›‘ EMERGENCY STOP</button>
            </div>
        </div>

        <!-- GÃ¶rÃ¼ntÃ¼ Ä°yileÅŸtirme Paneli - Fonksiyon adlarÄ± gÃ¼ncellendi -->
        <div class="panel">
            <h2>âœ¨ GÃ¶rÃ¼ntÃ¼ Ä°yileÅŸtirme</h2>
            <div class="button-group">
                <button class="toggle-btn" id="gammaBtn" onclick="toggleImageEnhancement('gamma')">Otomatik Gamma</button>
                <button class="toggle-btn" id="histogramBtn" onclick="toggleImageEnhancement('histogram')">Histogram EÅŸitleme</button>
            </div>
        </div>

        <!-- LED Kontrol Paneli - Yeni API'ye gÃ¶re gÃ¼ncellendi -->
        <div class="panel">
            <h2>ğŸ’¡ LED KontrolÃ¼</h2>
            <div class="button-group">
                <button class="toggle-btn" id="ledToggleBtn" onclick="toggleLed()">LED AÃ‡/KAPAT</button>
            </div>
            <div class="setting-row">
                <span class="setting-label">Manuel ParlaklÄ±k:</span>
                <div class="setting-control">
                    <input type="range" id="ledBrightness" class="range-input"
                           min="0" max="100" value="50"
                           oninput="updateLedBrightness()">
                    <span class="value-display" id="ledBrightnessValue">50%</span>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>ğŸ“Š System Status</h2>
            <div class="status-panel" id="statusPanel">
                <div class="status-item"><span>Human Tracking:</span><span class="status-value" id="trackingStatus">OFF</span></div>
                <div class="status-item"><span>Camera Tracking:</span><span class="status-value" id="cameraTrackingStatus">OFF</span></div>
                <div class="status-item"><span>Human Detected:</span><span class="status-value" id="humanStatus">NO</span></div>
                <div class="status-item"><span>Distance:</span><span class="status-value" id="distanceStatus">0 cm</span></div>
                <div class="status-item"><span>ROI Zone:</span><span class="status-value" id="roiStatus">CENTER</span></div>
                <div class="status-item"><span>Power Mode:</span><span class="status-value" id="powerStatus">MEDIUM</span></div>
                <div class="status-item"><span>Walking:</span><span class="status-value" id="walkingStatus">NO</span></div>
                <!-- JS tarafÄ±ndan doldurulacak ek durumlar buraya gelebilir -->
            </div>

            <h3>âš¡ Power Mode</h3>
            <select id="powerMode" onchange="setPowerMode()">
                <option value="low">ğŸ”‹ Low Power</option>
                <option value="medium" selected>âš¡ Medium Power</option>
                <option value="high">ğŸš€ High Power</option>
                <option value="max">ğŸ’¥ Maximum Power</option>
            </select>
        </div>

        <div class="panel">
            <h2>ğŸ® Manual Control</h2>

            <h3>ğŸš¶ Basic Movement</h3>
            <div class="direction-pad">
                <button class="up" onclick="manualMove('forward')">â¬†ï¸</button>
                <button class="left" onclick="manualMove('left')">â¬…ï¸</button>
                <button class="center" onclick="manualMove('stance')">ğŸ </button>
                <button class="right" onclick="manualMove('right')">â¡ï¸</button>
                <button class="down" onclick="manualMove('back')">â¬‡ï¸</button>
            </div>

            <h3>ğŸ•·ï¸ Spider Postures</h3>
            <div class="button-group">
                <button onclick="manualMove('defensive')">ğŸ›¡ï¸ Defensive</button>
                <button onclick="manualMove('attack')">âš”ï¸ Attack</button>
                <button onclick="manualMove('crouch')">ğŸ¦† Crouch</button>
            </div>

            <h3>ğŸ“· Manual Camera Control</h3>
            <div class="direction-pad">
                <button class="up" onclick="cameraControl('up')">â¬†ï¸</button>
                <button class="left" onclick="cameraControl('left')">â¬…ï¸</button>
                <button class="center" onclick="cameraControl('center')">ğŸ“</button>
                <button class="right" onclick="cameraControl('right')">â¡ï¸</button>
                <button class="down" onclick="cameraControl('down')">â¬‡ï¸</button>
            </div>
        </div>

        <!-- YENÄ° EKLENEN PANEL: PID AYARLARI -->
        <div class="panel">
            <h2>âš™ï¸ PID Tuning (Kamera Takibi)</h2>
            <div class="pid-controls">
                <div class="pid-axis">
                    <h4>Pan (Yatay)</h4>
                    <div class="setting-row"><label>Kp:</label><input type="range" id="pan_kp" min="0.001" max="0.1" step="0.001" value="0.04"><span id="pan_kp_val">0.040</span></div>
                    <div class="setting-row"><label>Ki:</label><input type="range" id="pan_ki" min="0.001" max="0.05" step="0.001" value="0.008"><span id="pan_ki_val">0.008</span></div>
                    <div class="setting-row"><label>Kd:</label><input type="range" id="pan_kd" min="0.001" max="0.05" step="0.001" value="0.015"><span id="pan_kd_val">0.015</span></div>
                </div>
                <div class="pid-axis">
                    <h4>Tilt (Dikey)</h4>
                    <div class="setting-row"><label>Kp:</label><input type="range" id="tilt_kp" min="0.001" max="0.1" step="0.001" value="0.04"><span id="tilt_kp_val">0.040</span></div>
                    <div class="setting-row"><label>Ki:</label><input type="range" id="tilt_ki" min="0.001" max="0.05" step="0.001" value="0.008"><span id="tilt_ki_val">0.008</span></div>
                    <div class="setting-row"><label>Kd:</label><input type="range" id="tilt_kd" min="0.001" max="0.05" step="0.001" value="0.015"><span id="tilt_kd_val">0.015</span></div>
                </div>
            </div>
            <button onclick="updatePidSettings()">PID AyarlarÄ±nÄ± GÃ¶nder</button>
        </div>

        <div class="panel">
            <h2>ğŸ“¹ Advanced Camera Settings</h2>
            <div class="camera-settings">
                <h3>ğŸ¯ Tracking Sensitivity</h3>
                <div class="setting-row">
                    <span class="setting-label">Dead Zone Radius:</span>
                    <div class="setting-control">
                        <input type="range" id="deadZoneRadius" class="range-input" min="20" max="150" value="60" oninput="updateCameraSettings()">
                        <span class="value-display" id="deadZoneValue">60px</span>
                    </div>
                </div>
                <div class="setting-row">
                    <span class="setting-label">Camera Speed:</span>
                    <div class="setting-control">
                        <input type="range" id="cameraStepSize" class="range-input" min="1" max="10" value="3" oninput="updateCameraSettings()">
                        <span class="value-display" id="stepSizeValue">3Â°</span>
                    </div>
                </div>
                <div class="setting-row">
                    <span class="setting-label">Smooth Delay:</span>
                    <div class="setting-control">
                        <input type="range" id="smoothDelay" class="range-input" min="10" max="200" value="50" oninput="updateCameraSettings()">
                        <span class="value-display" id="smoothDelayValue">0.05s</span>
                    </div>
                </div>
            </div>
            <div class="camera-settings">
                <h3>ğŸ“Š Camera Info</h3>
                <div class="status-panel">
                    <div class="status-item"><span>Pan Position:</span><span class="status-value" id="panPosition">90Â°</span></div>
                    <div class="status-item"><span>Tilt Position:</span><span class="status-value" id="tiltPosition">90Â°</span></div>
                    <div class="status-item"><span>Tracking Mode:</span><span class="status-value" id="trackingMode">MANUAL</span></div>
                </div>
            </div>
            <h3>ğŸ”§ Quick Camera Presets</h3>
            <div class="button-group">
                <button onclick="cameraPreset('home')">ğŸ  Home</button>
                <button onclick="cameraPreset('scan')">ğŸ” Scan Mode</button>
                <button onclick="cameraPreset('low')">â¬‡ï¸ Low Angle</button>
                <button onclick="cameraPreset('high')">â¬†ï¸ High Angle</button>
            </div>
        </div>

        <div class="panel">
            <h2>ğŸ¤– REX Quad Style Movement</h2>
            <h3>ğŸš€ REX 8-Phase Gaits</h3>
            <div class="direction-pad">
                <button class="up" onclick="rexMovement('rex_forward')">â¬†ï¸ REX FWD</button>
                <button class="left" onclick="rexMovement('rex_left')">â¬…ï¸ REX LEFT</button>
                <button class="center" onclick="rexMovement('rex_stabilize')">ğŸ  REX STANCE</button>
                <button class="right" onclick="rexMovement('rex_right')">â¡ï¸ REX RIGHT</button>
                <button class="down" onclick="rexMovement('rex_backward')">â¬‡ï¸ REX BACK</button>
            </div>
            <h3>ğŸ”„ REX Lean Control</h3>
            <div class="button-group">
                <button onclick="rexMovement('rex_lean_left')">â¬…ï¸ Lean Left</button>
                <button onclick="rexMovement('rex_lean_right')">â¡ï¸ Lean Right</button>
                <button onclick="rexMovement('rex_lean_forward')">â¬†ï¸ Lean Forward</button>
                <button onclick="rexMovement('rex_lean_back')">â¬‡ï¸ Lean Back</button>
            </div>
            <h3>ğŸ“ REX Stance Height</h3>
            <div class="setting-row">
                <span class="setting-label">Height:</span>
                <div class="setting-control">
                    <input type="range" id="rexStanceHeight" class="range-input" min="30" max="70" value="60" oninput="updateRexStance()">
                    <span class="value-display" id="rexStanceValue">60Â°</span>
                </div>
            </div>
            <h3>ğŸ›ï¸ REX Mode Toggle</h3>
            <div class="button-group">
                <button class="toggle-btn" id="rexModeBtn" onclick="toggleRexMode()">ğŸ¤– Enable REX Mode</button>
                <button onclick="rexDemo()">ğŸ¬ REX Demo</button>
            </div>
        </div>

        <div class="panel">
            <h2>ğŸ¤– Advanced Movement</h2>
            <h3>ğŸ§  Smart Gaits</h3>
            <div class="button-group">
                <button onclick="advancedMove('wave_gait')">ğŸŒŠ Wave Gait</button>
                <button onclick="advancedMove('creep_gait')">ğŸŒ Creep Gait</button>
            </div>
            <h3>ğŸ“ Adaptive Walking</h3>
            <div>
                <label>Distance (cm):</label>
                <input type="number" id="walkDistance" value="50" min="10" max="200">
                <br>
                <label>Direction:</label>
                <select id="walkDirection">
                    <option value="forward">Forward</option>
                    <option value="backward">Backward</option>
                    <option value="left">Left</option>
                    <option value="right">Right</option>
                </select>
                <br>
                <button onclick="adaptiveWalk()">ğŸ¯ Adaptive Walk</button>
            </div>
            <h3>ğŸ”¢ Multi-Step Movement</h3>
            <div>
                <label>Steps:</label>
                <input type="number" id="stepCount" value="3" min="1" max="10">
                <br>
                <button onclick="multiStep()">ğŸ¦¶ Multi-Step Walk</button>
            </div>
            <h3>âš™ï¸ ROI Settings</h3>
            <div>
                <label>Stop Distance (cm):</label>
                <input type="range" id="stopDistance" min="30" max="200" value="80" oninput="updateROI()">
                <span id="stopDistanceValue">80</span>
                <br>
                <label>Min Distance (cm):</label>
                <input type="range" id="minDistance" min="20" max="100" value="50" oninput="updateROI()">
                <span id="minDistanceValue">50</span>
                <br>
                <label>
                    <input type="checkbox" id="roiEnabled" checked onchange="updateROI()">
                    Enable ROI Detection
                </label>
            </div>
        </div>
    </div>

    <!-- Gereksiz script bloÄŸu kaldÄ±rÄ±ldÄ±. TÃ¼m JS mantÄ±ÄŸÄ± app.js'te olacak. -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
